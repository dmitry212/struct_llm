2025-05-06 21:04:37 - INFO - Logging initialized - logs will be written to nl_to_sql.log
2025-05-06 21:04:37 - INFO - Starting Natural Language to SQL Converter
2025-05-06 21:04:37 - INFO - Fetching database metadata...
2025-05-06 21:04:37 - INFO - Successfully retrieved database metadata for 3 tables
2025-05-06 21:05:09 - INFO - Creating prompt for LLM with question: list all the products
2025-05-06 21:05:09 - INFO - Sending request to Ollama API with prompt length: 1634
2025-05-06 21:05:27 - INFO - Successfully received SQL query from Ollama API: SELECT product_name, product_id FROM products;
2025-05-06 21:05:27 - INFO - Executing SQL query: SELECT product_name, product_id FROM products;
2025-05-06 21:05:27 - ERROR - Error occurred: Catalog Error: Table with name products does not exist!
Did you mean "pg_proc"?

LINE 1: SELECT product_name, product_id FROM products;
                                             ^
Traceback (most recent call last):
  File "/Users/dmitrygoodman/struct_llm/nl_to_sql.py", line 146, in main
    result = execute_query(sql)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/dmitrygoodman/struct_llm/nl_to_sql.py", line 116, in execute_query
    result = conn.execute(sql).fetchdf()
             ^^^^^^^^^^^^^^^^^
duckdb.duckdb.CatalogException: Catalog Error: Table with name products does not exist!
Did you mean "pg_proc"?

LINE 1: SELECT product_name, product_id FROM products;
                                             ^
2025-05-06 21:07:02 - INFO - Creating prompt for LLM with question: quit
2025-05-06 21:07:02 - INFO - Sending request to Ollama API with prompt length: 1617
2025-05-06 21:07:17 - INFO - Successfully received SQL query from Ollama API: --- Query to exit the session
  EXIT;
2025-05-06 21:07:17 - INFO - Executing SQL query: --- Query to exit the session
  EXIT;
2025-05-06 21:07:17 - ERROR - Error occurred: Parser Error: syntax error at or near "EXIT"
Traceback (most recent call last):
  File "/Users/dmitrygoodman/struct_llm/nl_to_sql.py", line 146, in main
  File "/Users/dmitrygoodman/struct_llm/nl_to_sql.py", line 116, in execute_query
duckdb.duckdb.ParserException: Parser Error: syntax error at or near "EXIT"
2025-05-06 21:08:49 - INFO - Logging initialized - level: INFO, logs will be written to nl_to_sql.log
2025-05-06 21:08:49 - INFO - Starting Natural Language to SQL Converter
